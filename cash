for c in safe_numeric_fields:
    if c in df.columns:
        df[c] = pd.to_numeric(df[c], errors="coerce")

# --- 保證至少有一個 field 可寫 ---
if not any(c in df.columns for c in safe_numeric_fields):
    df["count"] = 1.0
elif df[safe_numeric_fields].isna().all(axis=1).any():
    # 全空的列也給個 count=1
    df.loc[df[safe_numeric_fields].isna().all(axis=1), "count"] = 1.0
