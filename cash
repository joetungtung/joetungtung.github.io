# --- 統一可疑欄位為字串，避免 invalid boolean 問題 ---
force_string_fields = [
    "device_action", "severity", "rule_name",
    "agent_type", "agent_name",
    "protocol", "app_protocol",
]
for c in force_string_fields:
    if c in df.columns:
        df[c] = df[c].astype(str)

