def fix_influx_type_conflicts(df: pd.DataFrame):
    for col in df.columns:
        if df[col].dtype == object:  # 文字欄位
            # 針對 "passed", "blocked" 等關鍵字避免被當成 boolean
            df[col] = df[col].astype(str)
        elif df[col].dtype == bool:
            # Boolean 轉成字串 "true"/"false"
            df[col] = df[col].apply(lambda x: "true" if x else "false")
    return df


df = fix_influx_type_conflicts(df)
