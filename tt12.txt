from(bucket: "SOC")
  |> range(start: -12h)
  |> filter(fn: (r) => r._measurement == "arcsight_event")
  |> filter(fn: (r) => r.target_geo_country_name == "Taiwan")
  |> group(columns: ["attacker_geo_country_name"])
  |> count()
  |> rename(columns: {_value: "events"})
  |> keep(columns: ["attacker_geo_country_name", "events"])
  |> sort(columns: ["events"], desc: true)
  |> limit(n: 50)